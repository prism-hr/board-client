<h1 *ngIf="!post">Create a new post</h1>
<h1 *ngIf="post">Edit Post</h1>

<a routerLink="../">Back</a>

<form [formGroup]="postForm" (ngSubmit)="submit()" autocomplete="off" novalidate>

  <md-input-container class="md-block">
    <input mdInput formControlName="name" placeholder="Title of your post" required>
  </md-input-container>
  <control-messages [control]="postForm.controls.name"></control-messages>

  <div>
    <md-input-container class="md-block">
      <textarea mdInput formControlName="description" placeholder="Content of your post" required></textarea>
    </md-input-container>
    <control-messages [control]="postForm.controls.description"></control-messages>
  </div>

  <p>What is your post about?</p>
  <div formArrayName="postCategoriesMap">
    <label *ngFor="let category of board.postCategories; let i = index">
      <input type="checkbox"
             formControlName="{{i}}"/>
      {{category}}
    </label>
  </div>

  <div>
    <md-input-container class="md-block">
      <input mdInput formControlName="organizationName" placeholder="Your organization" required>
    </md-input-container>
    <control-messages [control]="postForm.controls.organizationName"></control-messages>
  </div>

  <div>
    <places-autocomplete formControlName="location"></places-autocomplete>
    <control-messages [control]="postForm.controls.location"></control-messages>
  </div>

  <div *ngIf="showExistingRelation">
    What is your relationship with our department?
    <md-select formControlName="existingRelation" placeholder="Relation with department">
      <md-option *ngFor="let relation of definitions.relationWithDepartment" [value]="relation">
        {{'definitions.relationWithDepartment.' + relation | translate}}
      </md-option>
    </md-select>
    <control-messages [control]="postForm.controls.existingRelation"></control-messages>
  </div>

  <p>Who do you want to share your post with?</p>
  <div formArrayName="memberCategoriesMap">
    <label *ngFor="let category of board.department.memberCategories; let i = index">
      <input type="checkbox"
             formControlName="{{i}}"/>
      {{category}}
    </label>
  </div>

  <div>
    How will people respond?
    <md-radio-group formControlName="applyType">
      <md-radio-button value="website">By visiting a web page</md-radio-button>
      <md-radio-button value="document">By following instructions in a document</md-radio-button>
      <md-radio-button value="email">By sending an email</md-radio-button>
    </md-radio-group>
    <control-messages [control]="postForm.controls.applyType"></control-messages>
  </div>

  <div *ngIf="postForm.value.applyType === 'website'">
    <md-input-container class="md-block">
      <input mdInput formControlName="applyWebsite" placeholder="Your website address" required>
    </md-input-container>
    <control-messages [control]="postForm.controls.applyWebsite"></control-messages>
  </div>

  <div *ngIf="postForm.value.applyType === 'document'">
    <file-upload formControlName="applyDocument" type="document"></file-upload>
    <control-messages [control]="postForm.controls.applyDocument"></control-messages>
  </div>

  <div *ngIf="postForm.value.applyType === 'email'">
    <md-input-container class="md-block">
      <input mdInput formControlName="applyEmail" placeholder="e.g. apply@example.com" required>
    </md-input-container>
    <control-messages [control]="postForm.controls.applyEmail"></control-messages>
  </div>

  <div layout="column" layout-align="space-between stretch">
    <button md-raised-button type="submit" [disabled]="postForm.invalid">Submit</button>
  </div>
</form>
